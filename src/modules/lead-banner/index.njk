{% set fields = {
    backgroundImage: { title: 'Background Image URL', type: 'Image URL', enabled: true },
    contentType: { title: 'Content Type', type: 'Simple text (selector)', enabled: true },
    verticalAlign: { title: 'Vertical Position', type: 'Simple text (selector)', enabled: true },
    textAlign: { title: 'Horizontal Position', type: 'Simple text (selector)', enabled: true },
    title: { title: 'Title', type: 'Rich Text', enabled: true },
    titleFontSize: { title: 'Title Font Size', type: 'Number', enabled: true },
    subtitle: { title: 'Subtitle', type: 'Rich Text', enabled: true },
    subtitleFontSize: { title: 'Subtitle Font Size', type: 'Number', enabled: true },
    titleImage: { title: 'Title Image URL', type: 'Image URL', enabled: true },
    titleImageAlt: { title: 'Title Image Alt Text', type: 'Simple text', enabled: true },
    titleImageWidth: { title: 'Title Image Width', type: 'Number', enabled: true },
    heroDesktopImage: { title: 'Desktop Hero Image URL', type: 'Image URL', enabled: true },
    heroMobileImage: { title: 'Mobile Hero Image URL', type: 'Image URL', enabled: true },
    heroAlt: { title: 'Hero Image Alt Text', type: 'Simple text', enabled: true },
    contentUrl: { title: 'Content Link URL', type: 'URL', enabled: true }
} %}
{% set module = { title: 'Lead Banner', fields: fields } %}
{% import "../_shared/form-macros.njk" as form %}
<!--
    UI FIELD MANIFEST: {{ module.title }}
    {% for key, field in fields %}
    - {{ key }} → {{ field.title }} ({{ field.type }}) [{% if field.enabled %}enabled{% else %}disabled{% endif %}]
    {% endfor %}
-->
{% set banner_settings %}
    {{ form.input_field({
        id: 'backgroundImage',
        label: module.fields.backgroundImage.title,
        inputType: 'url',
        placeholder: 'https://example.com/image.jpg',
        error: { id: 'backgroundImageError', text: 'Please enter a valid image URL.' }
    }) }}
{% endset %}

{% set text_options %}
    {{ form.option_selector({
        id: 'contentTypeSelector',
        label: module.fields.contentType.title,
        options: [
            { value: 'imageswap', label: 'Image Swap', selected: true },
            { value: 'text', label: 'Text' },
            { value: 'image', label: 'Image Title' }
        ]
    }) }}
    {{ form.option_selector({
        id: 'verticalAlignSelector',
        label: module.fields.verticalAlign.title,
        options: [
            { value: 'top', label: 'Top' },
            { value: 'middle', label: 'Middle', selected: true },
            { value: 'bottom', label: 'Bottom' }
        ]
    }) }}
    {{ form.option_selector({
        id: 'textAlignSelector',
        label: module.fields.textAlign.title,
        options: [
            { value: 'left', label: '<svg width="24" height="24" viewBox="0 0 24 24"><path d="M4 19h16v-2H4v2zm0-4h10v-2H4v2zm0-4h16v-2H4v2zM4 5v2h10V5H4z"/></svg>' },
            { value: 'center', label: '<svg width="24" height="24" viewBox="0 0 24 24"><path d="M4 19h16v-2H4v2zm4-4h8v-2H8v2zm-4-4h16v-2H4v2zm4-4h8V5H8v2z"/></svg>', selected: true },
            { value: 'right', label: '<svg width="24" height="24" viewBox="0 0 24 24"><path d="M4 19h16v-2H4v2zm6-4h10v-2H10v2zM4 9h16V7H4v2zm6-4h10V3H10v2z"/></svg>' }
        ]
    }) }}
{% endset %}

{% set text_content %}
<div id="textContent">
    {{ form.rich_text({
        label: module.fields.title.title,
        editorId: 'titleEditor',
        toolbarLimited: true,
        inline: [{
            id: 'titleFontSize',
            label: module.fields.titleFontSize.title ~ ' (px)',
            min: 20,
            max: 60,
            step: 4
        }]
    }) }}
    {{ form.rich_text({
        label: module.fields.subtitle.title,
        editorId: 'subtitleEditor',
        inline: [{
            id: 'subtitleFontSize',
            label: module.fields.subtitleFontSize.title ~ ' (px)',
            min: 12,
            max: 32,
            step: 4
        }]
    }) }}
</div>
{% endset %}

{% set image_content %}
<div id="imageContent" style="display: none;">
    {{ form.input_field({
        id: 'titleImage',
        label: module.fields.titleImage.title,
        inputType: 'url',
        placeholder: 'https://example.com/title-image.png',
        error: { id: 'titleImageError', text: 'Please enter a valid image URL.' }
    }) }}
    {{ form.input_field({
        id: 'titleImageAlt',
        label: module.fields.titleImageAlt.title,
        placeholder: 'Descriptive text for the image',
        inputType: 'text'
    }) }}
    {{ form.input_field({
        id: 'titleImageWidth',
        label: module.fields.titleImageWidth.title ~ ' (px)',
        inputType: 'number',
        min: 100,
        max: 500,
        step: 10
    }) }}
</div>
{% endset %}

{% set image_swap_content %}
<div id="imageSwapContent" style="display: none;">
    {{ form.input_field({
        id: 'heroDesktopImage',
        label: module.fields.heroDesktopImage.title,
        inputType: 'url',
        placeholder: 'https://example.com/desktop-hero.jpg',
        error: { id: 'heroDesktopImageError', text: 'Please enter a valid image URL.' }
    }) }}
    {{ form.input_field({
        id: 'heroMobileImage',
        label: module.fields.heroMobileImage.title,
        inputType: 'url',
        placeholder: 'https://example.com/mobile-hero.jpg',
        error: { id: 'heroMobileImageError', text: 'Please enter a valid image URL.' }
    }) }}
    {{ form.input_field({
        id: 'heroAlt',
        label: module.fields.heroAlt.title,
        inputType: 'text',
        placeholder: 'Descriptive text for the hero images'
    }) }}
</div>
{% endset %}

{% set content_footer %}
    {{ form.input_field({
        id: 'contentUrl',
        label: module.fields.contentUrl.title,
        inputType: 'url',
        placeholder: 'https://example.com/',
        error: { id: 'contentUrlError', text: 'Please enter a valid URL.' }
    }) }}
{% endset %}

{% set content_section %}
    {{ text_options }}
    <div class="section-divider" style="margin:20px 0; padding-top:15px;"></div>
    {{ text_content }}
    {{ image_content }}
    {{ image_swap_content }}
    {{ content_footer }}
{% endset %}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>{{ module.title }} Block</title>
    {% include "../_shared/lead-banner-head.njk" %}
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay"><div class="loading-spinner"></div></div>

    <div class="container" id="mainContainer">
        <h2 style="margin-top: 0; color: #333;">{{ module.title }}</h2>
        <div class="error-banner" id="errorBanner"></div>

        <div class="config-tools">
            <button id="copyConfigBtn" class="config-btn" title="Copy Configuration">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
            </button>
            <button id="pasteConfigBtn" class="config-btn" title="Paste Configuration">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg>
            </button>
        </div>

        <div class="help-banner">
            <a href="https://example.com/image-overlay-tool" target="_blank" rel="noopener noreferrer">Click here to open the Image Overlay Tool →</a>
        </div>

        {{ form.section('Banner Settings', banner_settings, { first: true }) }}
        {{ form.section('Content', content_section) }}
    </div>

    <div id="pasteModal" class="paste-modal">
        <div class="paste-modal-content">
            <div class="paste-modal-icon">
                <svg viewBox="0 0 24 24"><path d="M19 2h-4.18C14.4.84 13.3 0 12 0c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm7 18H5V4h2v3h10V4h2v16z"/></svg>
            </div>
            <h3 class="paste-modal-title">Ready to Paste</h3>
            <p class="paste-modal-instructions">Press <strong>Ctrl+V</strong> (or <strong>Cmd+V</strong> on Mac) to paste your copied block configuration.</p>
            <div class="paste-modal-hint" id="pasteModalHint">The block will automatically update with the pasted settings</div>
            <div class="paste-modal-footer">
                <button id="pasteModalCancel" class="paste-modal-btn secondary">Cancel</button>
            </div>
        </div>
    </div>
    <textarea id="pasteHiddenTextarea" class="paste-hidden-textarea"></textarea>

    {% include "../_shared/lead-banner-scripts.njk" %}

</body>
</html>
