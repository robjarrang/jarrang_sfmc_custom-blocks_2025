{% set fields = {
    productImage: { title: 'Product Image URL', type: 'Image URL', enabled: true },
    productImageAlt: { title: 'Product Image Alt Text', type: 'Simple text', enabled: true },
    productUrl: { title: 'Product Link URL', type: 'URL', enabled: true },
    showSubtitle: { title: 'Show Subtitle', type: 'Toggle', enabled: true },
    subtitle: { title: 'Subtitle', type: 'Simple text', enabled: true },
    subtitleFontSize: { title: 'Subtitle Font Size', type: 'Number', enabled: true },
    productTitle: { title: 'Product Title', type: 'Rich Text', enabled: true },
    productTitleFontSize: { title: 'Product Title Font Size', type: 'Number', enabled: true },
    contentType: { title: 'Content Type', type: 'Simple text (selector)', enabled: true },
    checklistItems: { title: 'Checklist Items', type: 'List of Rich Text', enabled: true },
    showButton: { title: 'Show Button', type: 'Toggle', enabled: true },
    buttonText: { title: 'Button Text', type: 'Rich Text', enabled: true },
    buttonUrl: { title: 'Button Link URL', type: 'URL', enabled: true }
} %}
{% set module = { title: 'Product Feature', fields: fields } %}
<!--
    UI FIELD MANIFEST: {{ module.title }}
    {% for key, field in fields %}
    - {{ key }} → {{ field.title }} ({{ field.type }}) [{% if field.enabled %}enabled{% else %}disabled{% endif %}]
    {% endfor %}
-->
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>{{ module.title }} Block</title>
    {% include "../_shared/product-feature-head.njk" %}
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <div class="container" id="mainContainer">
        <h2 style="margin-top: 0; color: #333;">{{ module.title }}</h2>

        <div class="error-banner" id="errorBanner"></div>

        <!-- Copy/Paste Tools -->
        <div class="config-tools">
            <button id="copyConfigBtn" class="config-tool-btn" title="Copy block configuration to clipboard">
                <svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
            </button>
            <button id="pasteConfigBtn" class="config-tool-btn" title="Paste block configuration from clipboard">
                <svg viewBox="0 0 24 24"><path d="M19 2h-4.18C14.4.84 13.3 0 12 0c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm7 18H5V4h2v3h10V4h2v16z"/></svg>
            </button>
        </div>

        <!-- Product Settings -->
        <div class="section-divider" style="margin-top:0; padding-top:0; border-top:none;">
            <div class="section-title">Product Settings</div>
            <div class="field-group">
                <label for="productImage" class="field-label">{{ module.fields.productImage.title }}</label>
                <input type="url" id="productImage" class="field-input" placeholder="https://example.com/product-image.jpg">
                <div class="field-error" id="productImageError">Please enter a valid image URL (http:// or https://)</div>
            </div>
            <div class="field-group">
                <label for="productImageAlt" class="field-label">{{ module.fields.productImageAlt.title }}</label>
                <input type="text" id="productImageAlt" class="field-input" placeholder="Product name or description">
            </div>
            <div class="field-group">
                <label for="productUrl" class="field-label">{{ module.fields.productUrl.title }}</label>
                <input type="url" id="productUrl" class="field-input" placeholder="https://example.com/product-page">
                <div class="field-error" id="productUrlError">Please enter a valid URL (http:// or https://)</div>
            </div>
        </div>

        <!-- Content Settings -->
        <div class="section-divider">
            <div class="section-title">Product Information</div>
            <div class="toggle-container">
                <label class="toggle-switch">
                    <input type="checkbox" id="showSubtitle" checked>
                    <span class="toggle-slider"></span>
                </label>
                <label for="showSubtitle" class="checkbox-label">{{ module.fields.showSubtitle.title }}</label>
            </div>
            <div class="field-group" id="subtitleGroup">
                <label for="subtitle" class="field-label">{{ module.fields.subtitle.title }}</label>
                <input type="text" id="subtitle" class="field-input" placeholder="M12 FHAC16-502X">
                 <!-- NEW: Subtitle Font Size Control -->
                <div class="field-group-inline">
                    <label for="subtitleFontSize" class="field-label">{{ module.fields.subtitleFontSize.title }} (px)</label>
                    <input type="number" id="subtitleFontSize" class="field-input" min="12" max="28" step="4">
                </div>
            </div>
            <div class="field-group">
                <label class="field-label">{{ module.fields.productTitle.title }}</label>
                <div id="productTitleEditor" class="quill-container limited-toolbar"></div>
                 <!-- NEW: Product Title Font Size Control -->
                <div class="field-group-inline">
                    <label for="productTitleFontSize" class="field-label">{{ module.fields.productTitleFontSize.title }} (px)</label>
                    <input type="number" id="productTitleFontSize" class="field-input" min="16" max="48" step="4">
                </div>
            </div>

            <!-- Content Type Selection -->
            <div class="field-group">
                <label class="field-label">{{ module.fields.contentType.title }}</label>
                <div class="option-selector" id="contentTypeSelector">
                    <div class="option-button selected" data-value="none">None</div>
                    <div class="option-button" data-value="checklist">Checklist</div>
                </div>
            </div>

            <!-- Checklist Content -->
            <div class="field-group" id="checklistGroup" style="display: none;">
                <label class="field-label">{{ module.fields.checklistItems.title }}</label>
                <div id="itemsContainer" class="items-container"></div>
                <button id="addItemBtn" class="btn add-item-btn">Add New Item</button>
            </div>
        </div>

        <!-- Button Settings -->
        <div class="section-divider">
            <div class="section-title">Button Settings</div>
            <div class="toggle-container">
                <label class="toggle-switch">
                    <input type="checkbox" id="showButton" checked>
                    <span class="toggle-slider"></span>
                </label>
                <label for="showButton" class="checkbox-label">{{ module.fields.showButton.title }}</label>
            </div>
            <div id="buttonFieldsGroup">
                <div class="field-group">
                    <label for="buttonTextEditor" class="field-label">{{ module.fields.buttonText.title }}</label>
                    <div id="buttonTextEditor" class="quill-container limited-toolbar"></div>
                </div>
                <div class="field-group">
                    <label for="buttonUrl" class="field-label">{{ module.fields.buttonUrl.title }}</label>
                    <input type="url" id="buttonUrl" class="field-input" placeholder="https://example.com/">
                    <div class="field-error" id="buttonUrlError">Please enter a valid URL (http:// or https://)</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Paste Modal -->
    <div id="pasteModal" class="paste-modal">
        <div class="paste-modal-content">
            <div class="paste-modal-icon">
                <svg viewBox="0 0 24 24"><path d="M19 2h-4.18C14.4.84 13.3 0 12 0c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm7 18H5V4h2v3h10V4h2v16z"/></svg>
            </div>
            <h3 class="paste-modal-title">Ready to Paste</h3>
            <p class="paste-modal-instructions">Press <strong>Ctrl+V</strong> (or <strong>Cmd+V</strong> on Mac) to paste your copied block configuration.</p>
            <div class="paste-modal-hint" id="pasteModalHint">The block will automatically update with the pasted settings</div>
            <div class="paste-modal-footer">
                <button id="pasteModalCancel" class="paste-modal-btn secondary">Cancel</button>
            </div>
        </div>
    </div>
    <textarea id="pasteHiddenTextarea" class="paste-hidden-textarea"></textarea>

    <template id="itemTemplate">
        <div class="item">
            <div class="item-header">
                <h3 class="item-title">Item</h3>
                <div class="item-controls">
                    <button class="item-control-btn move-up-btn" title="Move Up">▲</button>
                    <button class="item-control-btn move-down-btn" title="Move Down">▼</button>
                    <button class="item-control-btn remove-btn" title="Remove Item">×</button>
                </div>
            </div>
            <div class="quill-container limited-toolbar"></div>
        </div>
    </template>

    {% include "../_shared/product-feature-scripts.njk" %}

</body>
</html>
